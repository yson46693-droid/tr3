[02-Dec-2025 16:15:33 Africa/Cairo] 'return_request' already exists in approvals.type enum
[02-Dec-2025 16:15:37 Africa/Cairo] 'return_request' already exists in approvals.type enum
[02-Dec-2025 16:15:37 Africa/Cairo] === API: Approving return ID: 33 by user: 1 ===
[02-Dec-2025 16:15:37 Africa/Cairo] === APPROVE RETURN START - Return ID: 33 ===
[02-Dec-2025 16:15:37 Africa/Cairo] Return 33 status updated to 'approved', affected rows: 1
[02-Dec-2025 16:15:37 Africa/Cairo] >>> processReturnFinancials START - Return ID: 33
[02-Dec-2025 16:15:37 Africa/Cairo] >>> returnProductsToVehicleInventory START - Return ID: 33
[02-Dec-2025 16:15:37 Africa/Cairo] PHP Error [2]: Undefined variable $quantityBefore in /home/vol13_4/infinityfree.com/if0_40278066/almostafa.free.nf/htdocs/v1/includes/inventory_movements.php on line 168
[02-Dec-2025 16:15:37 Africa/Cairo] PHP Error [2]: Undefined variable $quantityBefore in /home/vol13_4/infinityfree.com/if0_40278066/almostafa.free.nf/htdocs/v1/includes/inventory_movements.php on line 171
[02-Dec-2025 16:15:37 Africa/Cairo] recordInventoryMovement: Skipping products.quantity update for vehicle warehouse, using vehicle_inventory instead
[02-Dec-2025 16:15:37 Africa/Cairo] PHP Error [2]: Undefined variable $quantityBefore in /home/vol13_4/infinityfree.com/if0_40278066/almostafa.free.nf/htdocs/v1/includes/inventory_movements.php on line 249
[02-Dec-2025 16:15:37 Africa/Cairo] Inventory Movement Error: Column 'quantity_before' cannot be null | Product ID: 3 | Warehouse ID: 7 | Type: in | Quantity: 1
[02-Dec-2025 16:15:37 Africa/Cairo] >>> applyReturnSalaryDeduction START - Return ID: 33
[02-Dec-2025 16:15:37 Africa/Cairo] Applied salary deduction: user_id=13, salary_id=198, old_deductions=1, new_deductions=2, deduction_amount=1
[02-Dec-2025 16:15:37 Africa/Cairo] Return 33 status updated to 'processed' in transaction, affected rows: 1
[02-Dec-2025 16:15:37 Africa/Cairo] === APPROVE RETURN START - Return ID: 33 ===
[02-Dec-2025 16:15:37 Africa/Cairo] Error updating entity status in approveRequest (type: return_request, id: 33): Ù„Ø§ ÙŠÙ…ÙƒÙ† Ø§Ù„Ù…ÙˆØ§ÙÙ‚Ø© Ø¹Ù„Ù‰ Ù…Ø±ØªØ¬Ø¹ ØªÙ…Øª Ù…Ø¹Ø§Ù„Ø¬ØªÙ‡ Ø¨Ø§Ù„ÙØ¹Ù„
[02-Dec-2025 16:15:37 Africa/Cairo] Approval Error: Ù„Ø§ ÙŠÙ…ÙƒÙ† Ø§Ù„Ù…ÙˆØ§ÙÙ‚Ø© Ø¹Ù„Ù‰ Ù…Ø±ØªØ¬Ø¹ ØªÙ…Øª Ù…Ø¹Ø§Ù„Ø¬ØªÙ‡ Ø¨Ø§Ù„ÙØ¹Ù„
[02-Dec-2025 16:15:37 Africa/Cairo] ERROR: Return 33 status is 'approved' instead of 'processed' after commit!
[02-Dec-2025 16:15:37 Africa/Cairo] === APPROVE RETURN COMPLETED SUCCESSFULLY ===
[02-Dec-2025 16:15:37 Africa/Cairo] === API: Approve result: {"success":true,"message":"ØªÙ…Øª Ø§Ù„Ù…ÙˆØ§ÙÙ‚Ø© Ø¹Ù„Ù‰ Ø·Ù„Ø¨ Ø§Ù„Ù…Ø±ØªØ¬Ø¹ Ø¨Ù†Ø¬Ø§Ø­","success_message":"âœ… ØªÙ…Øª Ø§Ù„Ù…ÙˆØ§ÙÙ‚Ø© Ø¹Ù„Ù‰ Ø·Ù„Ø¨ Ø§Ù„Ù…Ø±ØªØ¬Ø¹ Ø¨Ù†Ø¬Ø§Ø­!\n\nØªÙ… Ø®ØµÙ… 50.00 Ø¬.Ù… Ù…Ù† Ø¯ÙŠÙ† Ø§Ù„Ø¹Ù…ÙŠÙ„ ÙˆØ¥Ø¶Ø§ÙØ© 50.00 Ø¬.Ù… Ù„Ø±ØµÙŠØ¯Ù‡ Ø§Ù„Ø¯Ø§Ø¦Ù†\nØªÙ… Ø®ØµÙ… 2% (1.00 Ø¬.Ù…) Ù…Ù† Ø±Ø§ØªØ¨ Ø§Ù„Ù…Ù†Ø¯ÙˆØ¨\n\nğŸ“¦ ØªÙ… Ø¥Ø±Ø¬Ø§Ø¹ 1 Ù…Ù†ØªØ¬(Ø§Øª) Ø¥Ù„Ù‰ Ù…Ø®Ø²Ù† Ø§Ù„Ø³ÙŠØ§Ø±Ø©","financial_note":"ØªÙ… Ø®ØµÙ… 50.00 Ø¬.Ù… Ù…Ù† Ø¯ÙŠÙ† Ø§Ù„Ø¹Ù…ÙŠÙ„ ÙˆØ¥Ø¶Ø§ÙØ© 50.00 Ø¬.Ù… Ù„Ø±ØµÙŠØ¯Ù‡ Ø§Ù„Ø¯Ø§Ø¦Ù†\nØªÙ… Ø®ØµÙ… 2% (1.00 Ø¬.Ù…) Ù…Ù† Ø±Ø§ØªØ¨ Ø§Ù„Ù…Ù†Ø¯ÙˆØ¨","new_balance":-50,"penalty_applied":1,"items_returned":1,"return_number":"RET-202512-0009"} ===
[02-Dec-2025 16:15:43 Africa/Cairo] 'return_request' already exists in approvals.type enum
